<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bảng điều khiển</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container">
        <a class="navbar-brand fw-bold" style="color: #c81e1e;" th:href="@{/}">HỆ THỐNG HIẾN MÁU</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <li class="nav-item"><a class="nav-link" th:href="@{/blood-info}">Tài liệu nhóm máu</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/blogs}">Blog kinh nghiệm</a></li>
                <li class="nav-item" sec:authorize="isAnonymous()">
                    <a class="btn btn-outline-danger me-2" th:href="@{/login}">Đăng nhập</a>
                    <a class="btn btn-danger" th:href="@{/register}">Đăng ký</a>
                </li>
                <li class="nav-item" sec:authorize="isAuthenticated()">
                    <a class="btn btn-primary me-2" th:href="@{/dashboard}">Bảng điều khiển</a>
                    <form th:action="@{/perform_logout}" method="post" class="d-inline">
                        <button class="btn btn-outline-secondary" type="submit">Đăng xuất</button>
                    </form>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container my-5">
    <div class="p-5 mb-4 bg-light rounded-3">
        <div class="container-fluid py-5">
            <h1 class="display-5 fw-bold">Chào mừng trở lại, <span th:text="${loggedInUser.fullName}"></span>!</h1>
            <p class="col-md-8 fs-4">
                Cảm ơn bạn đã là một phần của cộng đồng. Tại đây bạn có thể quản lý thông tin cá nhân,
                đăng ký hiến máu và xem lại lịch sử của mình.
            </p>
        </div>
    </div>

    <!-- Admin Section -->
    <div class="col-12 mb-4" sec:authorize="hasAuthority('ADMIN')">
        <div class="card text-white bg-danger">
             <div class="card-header fs-5 fw-bold">Khu vực Quản trị viên</div>
             <div class="card-body">
                <h5 class="card-title">Chào mừng Admin!</h5>
                <p class="card-text">Bạn có quyền truy cập các chức năng quản lý hệ thống.</p>
                <a th:href="@{/admin/users}" class="btn btn-light fw-bold">Quản lý Người dùng &rarr;</a>
                <a th:href="@{/admin/emergency-requests}" class="btn btn-light fw-bold ms-2">Quản lý Yêu cầu máu &rarr;</a>
                <a th:href="@{/admin/inventory}" class="btn btn-light fw-bold ms-2">Quản lý Kho máu &rarr;</a>
             </div>
        </div>
    </div>

    <!-- Staff Section -->
    <div class="col-12 mb-4" sec:authorize="hasAuthority('STAFF')">
        <div class="card text-white bg-primary">
             <div class="card-header fs-5 fw-bold">Khu vực Vận hành</div>
             <div class="card-body">
                <h5 class="card-title">Bảng điều khiển Nhân viên</h5>
                <p class="card-text">Xem tổng quan, quản lý yêu cầu và kho máu.</p>
                <a th:href="@{/staff/dashboard}" class="btn btn-light fw-bold">Đi đến &rarr;</a>
                <a th:href="@{/donations/register}" class="btn btn-light fw-bold ms-2">Đăng ký hiến máu &rarr;</a>
                <a th:href="@{/donations/history}" class="btn btn-light fw-bold ms-2">Lịch sử hiến máu &rarr;</a>
                <a th:href="@{/profile}" class="btn btn-light fw-bold ms-2">Hồ sơ cá nhân &rarr;</a>
             </div>
        </div>
    </div>

    <!-- Member Section -->
    <div class="row" sec:authorize="hasAuthority('MEMBER')">
        <div class="col-md-4">
            <div class="card text-center h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">Hồ sơ cá nhân</h5>
                    <p class="card-text">Xem và cập nhật thông tin cá nhân của bạn.</p>
                    <a th:href="@{/profile}" class="btn btn-primary mt-auto">Quản lý hồ sơ</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">Đăng ký hiến máu</h5>
                    <p class="card-text">Đặt lịch và đăng ký sẵn sàng hiến máu khi cần.</p>
                    <a th:href="@{/donations/register}" class="btn btn-danger mt-auto">Đăng ký ngay</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">Lịch sử hiến máu</h5>
                    <p class="card-text">Xem lại những lần hiến máu đầy ý nghĩa của bạn.</p>
                    <a th:href="@{/donations/history}" class="btn btn-secondary mt-auto">Xem lịch sử</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mt-4">
            <div class="card text-center h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">Yêu cầu máu khẩn cấp</h5>
                    <p class="card-text">Tạo một yêu cầu cần máu cho bản thân hoặc người thân.</p>
                    <a th:href="@{/requests/emergency/new}" class="btn btn-warning mt-auto">Tạo yêu cầu</a>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="bg-light text-center text-lg-start mt-auto py-3">
    <div class="text-center">© 2025 Bản quyền: Hệ thống Hỗ trợ Hiến máu</div>
</footer>

</body>
</html>
